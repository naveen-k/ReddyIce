<div class="row">
    <div class=" col-md-12">
        <ba-card cardTitle="Trip Details" baCardClass="with-scroll" class="smart-table-container" #customer>
            <div class="head-button-container">
                <button class="btn btn-danger pull-right" *ngIf="tripData.TripStatusID==24 || user?.IsDistributor" [disabled]="!tripData.IsClosed" (click)="submitTickets()">Approve</button>
                <button class="btn btn-danger pull-right add-margin-right" [routerLink]="['../../']">Back</button>
            </div>
            <div class="row">
                <div class=" col-md-12">
                    <div class="row page-header bold-head">
                        <div class="col-md-3">
                            <span>Branch:</span>
                            <label>{{tripData.BranchID}} - {{tripData.BranchName}}</label>
                        </div>
                        <div class="col-md-2">
                            <span>Route:</span>
                            <label>{{tripData.IsUnplanned?'Unplanned':tripData.RouteNumber}}</label>
                        </div>
                        <div class="col-md-2">
                            <span>Driver:</span>
                            <label>{{tripData.DriverName}}</label>
                        </div>
                        <div class="col-md-2">
                            <span>HH Day End:</span>
                            <label>{{tripData.IsClosed?'Yes':'No'}}</label>
                        </div>
                        <div class="col-md-3">
                            <span>Trip Start Date:</span>
                            <label>{{tripData.TripStartDate|date}}</label>
                        </div>
                    </div>
                    <div class="row page-header bold-head">
                        <div class="col-md-3">
                            <span>Trip Code:</span>
                            <label>{{tripData.TripCode}}</label>
                        </div>
                        <div class="col-md-2">
                            <span>Truck:</span>
                            <label>{{tripData.TruckID}}</label>
                        </div>
                        <div class="col-md-2">
                            <div>
                                <span>Status:</span>
                                <label>{{tripStatus(tripData.TripStatusID)}}</label>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <span>ERP Processed:</span>
                            <label>{{tripData.IsProcessed?'Yes':'No'}}</label>
                        </div>
                        <div class="col-md-3">
                            <span>Trip End Date:</span>
                            <label>{{tripData.TripEndDate|date}}</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row page-header">
                <div class="col-sm-6">
                    <h3>Ticket Details</h3>
                </div>
                <div class="col-sm-6">
                    <button class="btn btn-danger pull-right" [hidden]='tripData.TripStatusID == 24 || tripData.TripStatusID == 25' [routerLink]="['../../../manual-ticket/trip-ticket',tripId]"
                    [queryParams]="{branchId:tripData.BranchID, driverId:tripData.UserID, isDistributor:tripData.DistributorMasterID, sdate:tripData.TripStartDate, edate:tripData.TripEndDate}">Create Ticket</button>
                </div>
                <div class="col-sm-12 page-header">
                    <table class="table table-striped">
                        <thead class="tableHeader">
                            <tr>
                                <th>
                                    <span style="cursor:pointer;" (click)="customer.sortField = 'Customerid';customer.isAsc=!customer.isAsc;">
                                        Customer 
                                            <i *ngIf="(customer.sortField == 'Customerid')" [ngClass]="(customer.isAsc && customer.sortField == 'Customerid' ? 'fa fa-chevron-up' : 'fa fa-chevron-down')"></i> 
                                        </span>
                                </th>
                                <th>
                                    <span style="cursor:pointer;" (click)="customer.sortField = 'ISRICustomer';customer.isAsc=!customer.isAsc;">
                                  RI Customer?
                                     <i *ngIf="(customer.sortField == 'ISRICustomer')" [ngClass]="(customer.isAsc && customer.sortField == 'ISRICustomer' ? 'fa fa-chevron-up' : 'fa fa-chevron-down')"></i> 
                                </span>
                                </th>
                                <th>
                                    <span style="cursor:pointer;" (click)="customer.sortField = 'TicketNumber';customer.isAsc=!customer.isAsc;">
                                    Ticket Number
                                     <i *ngIf="(customer.sortField === 'TicketNumber')" [ngClass]="(customer.isAsc && customer.sortField === 'TicketNumber' ? 'fa fa-chevron-up' : 'fa fa-chevron-down')"></i> 
                                </span>
                                </th>
                                <th class="right">
                                    <span style="cursor:pointer;" (click)="customer.sortField = 'InVoiceAmount';customer.isAsc=!customer.isAsc;">
                                    Invoice Amount
                                     <i *ngIf="(customer.sortField === 'InVoiceAmount')" [ngClass]="(customer.isAsc && customer.sortField === 'InVoiceAmount' ? 'fa fa-chevron-up' : 'fa fa-chevron-down')"></i> 
                                </span>
                                </th>
                                <th class="right">
                                    <span style="cursor:pointer;" (click)="customer.sortField = 'CashAmount';customer.isAsc=!customer.isAsc;">
                                    Cash
                                     <i *ngIf="(customer.sortField === 'CashAmount')" [ngClass]="(customer.isAsc && customer.sortField === 'CashAmount' ? 'fa fa-chevron-up' : 'fa fa-chevron-down')"></i> 
                                </span>
                                </th>
                                <th class="right">
                                    <span style="cursor:pointer;" (click)="customer.sortField = 'check';customer.isAsc=!customer.isAsc;">
                                    Check
                                     <i *ngIf="(customer.sortField === 'check')" [ngClass]="(customer.isAsc && customer.sortField === 'check' ? 'fa fa-chevron-up' : 'fa fa-chevron-down')"></i> 
                                </span>
                                </th>
                                <th class="right">
                                    <span style="cursor:pointer;" (click)="customer.sortField = 'ChargeAmount';customer.isAsc=!customer.isAsc;">
                                    Charge
                                     <i *ngIf="(customer.sortField === 'ChargeAmount')" [ngClass]="(customer.isAsc && customer.sortField === 'ChargeAmount' ? 'fa fa-chevron-up' : 'fa fa-chevron-down')"></i> 
                                </span>
                                </th>
                                <th class="right">
                                    <span style="cursor:pointer;" (click)="customer.sortField = 'Drayage';customer.isAsc=!customer.isAsc;">
                                    Drayage
                                     <i *ngIf="(customer.sortField === 'Drayage')" [ngClass]="(customer.isAsc && customer.sortField === 'Drayage' ? 'fa fa-chevron-up' : 'fa fa-chevron-down')"></i> 
                                </span>
                                </th>
                                <th class="right">
                                    <span style="cursor:pointer;" (click)="customer.sortField = 'BuyBack';customer.isAsc=!customer.isAsc;">
                                    Buy Back
                                     <i *ngIf="(customer.sortField === 'BuyBack')" [ngClass]="(customer.isAsc && customer.sortField === 'BuyBack' ? 'fa fa-chevron-up' : 'fa fa-chevron-down')"></i> 
                                </span>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <!--Removed sorting functionality as it was causing rendering issues  -->
                            <tr *ngFor="let item of tripData?.TripTicketList | sort:customer.sortField:customer.isAsc">

                                <td>{{item.Customerid}} {{item.CustomerName }}</td>
                                <td>{{item.IsRICustomer }}</td>
                                <td>{{item.TicketNumber}}</td>
                                <td>{{item.TotalSale| currency:'USD':true:'1.2'}}</td>
                                <td>{{item.CashAmount| currency:'USD':true:'1.2'}}</td>
                                <td>{{item.CheckAmount| currency:'USD':true:'1.2'}}</td>
                                <td>{{item.ChargeAmount || '0' | currency:'USD':true:'1.2'}}</td>
                                <td>{{item.Drayage| currency:'USD':true:'1.2'}}</td>
                                <td>{{item.BuyBack| currency:'USD':true:'1.2'}}</td>
                            </tr>
                            <tr>
                                <td colspan="3">Total</td>
                                <td class="textRightPadd">{{total.totalInvoice | currency:'USD':true:'1.2'}}</td>
                                <td class="textRightPadd">{{total.totalCash | currency:'USD':true:'1.2'}}</td>
                                <td class="textRightPadd">{{total.totalCheck | currency:'USD':true:'1.2'}}</td>
                                <td class="textRightPadd">{{total.totalCharge | currency:'USD':true:'1.2'}}</td>
                                <td class="textRightPadd">{{total.totalDrayage | currency:'USD':true:'1.2'}}</td>
                                <td class="textRightPadd">{{total.totalBuyBack | currency:'USD':true:'1.2'}}</td>
                            </tr>
                            <tr *ngIf="tripData.TripTicketList?.length < 1" class="text-center">
                                <td colspan="10">No data found</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </ba-card>
    </div>
</div>